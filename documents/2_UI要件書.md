# UI要件書

## 概要

本ドキュメントは、MedalCompass（dqwfunメダルコンパス）のUI/UX要件を記載しています。要件定義フェーズとして、具体的な実装方法ではなく、UIに求められる要件を定義します。

---

## UI/UX基本方針

### コンセプト
- **超シンプルなUI/UX**: マップ中心、最小限のUI要素
- **歩きながら使える**: 大きなボタン、タップしやすいUI
- **直感的な操作**: 説明不要で使える操作性
- **視認性が高い**: 明確な色分けで状態を表現

### デザイン原則
1. **シンプル**: 機能を絞り込み、迷わせない
2. **わかりやすい**: 視覚的に理解しやすい
3. **安全**: 歩きながらでも操作しやすい
4. **快適**: ストレスのない応答速度

---

## カラー要件

### メダル表示色

**探検モード:**
- 未獲得メダル: 金色
- 獲得済みメダル: グレー

**登録モード:**
- 自分のメダル: 金色
- 他人のメダル: グレー

**登録＆獲得モード:**
- 未獲得のメダル: 金色
- 獲得済みのメダル: グレー

**過去シーズン（参照のみ）:**
- 全メダル: 金色
- 探検モード固定（モード切り替え不可）
- 登録・獲得・削除・通報は不可

### UI要素色
- **プライマリカラー**: エメラルドグリーン（ボタン、アクティブ要素）
- **成功**: 緑（成功メッセージ）
- **エラー**: 赤（エラーメッセージ、削除ボタン）
- **警告**: オレンジ（警告メッセージ、通報ボタン）
- **情報**: 青（情報メッセージ）

---

## タイポグラフィ要件

### フォント
- システムデフォルトフォントを使用
- iOS: San Francisco
- Android: Roboto

### サイズ階層
- 特大: 画面タイトル
- 大: セクションタイトル
- 中: ボタンテキスト、本文
- 小: サブテキスト、キャプション
- 極小: 注釈、補足情報

### 太さ階層
- Bold: 見出し、ボタン
- Medium: 強調テキスト
- Regular: 本文、通常テキスト

---

## 画面構成要件

### SC001: ログイン画面

**レイアウト図:**
```
┌──────────────────────────────────┐
│                                  │
│                                  │
│     dqwfunメダルコンパス         │
│                                  │
│                                  │
│  ┌────────────────────────────┐ │
│  │ メールアドレス              │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ example@email.com          │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │ パスワード                  │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ ••••••••                   │ │
│  └────────────────────────────┘ │
│                                  │
│  ☑ ログイン情報を記憶する        │
│                                  │
│  ┌────────────────────────────┐ │
│  │       ログイン             │ │
│  └────────────────────────────┘ │
│                                  │
│       新規登録はこちら           │
│     パスワードを忘れた方         │
│                                  │
└──────────────────────────────────┘
```

**必要な要素:**
- アプリタイトル表示
- メールアドレス入力フィールド
- パスワード入力フィールド
- ログイン情報を記憶するチェックボックス
- ログインボタン
- 新規登録へのリンク
- パスワードリセットへのリンク

**バリデーション要件:**
- メールアドレス形式チェック
- パスワード未入力チェック
- エラー表示は日本語で明確に

**ログイン情報記憶機能:**
- チェックボックスでON/OFF切り替え
- デフォルトはOFF（セキュリティ上の理由）
- ON + ログイン成功時、メールアドレスとパスワードを保存
- 次回表示時、保存情報がある場合は自動入力

---

### SC002: 新規登録画面

**レイアウト図:**
```
┌──────────────────────────────────┐
│  [<] 新規登録                    │
├──────────────────────────────────┤
│                                  │
│  ┌────────────────────────────┐ │
│  │ メールアドレス              │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ example@email.com          │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │ パスワード（6文字以上）     │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ ••••••••                   │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │ パスワード（確認）          │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ ••••••••                   │ │
│  └────────────────────────────┘ │
│                                  │
│  ☐ 利用規約・プライバシー      │
│     ポリシーに同意する          │
│                                  │
│  ┌────────────────────────────┐ │
│  │         登録               │ │
│  └────────────────────────────┘ │
│                                  │
└──────────────────────────────────┘
```

**必要な要素:**
- 戻るボタン
- メールアドレス入力フィールド
- パスワード入力フィールド（6文字以上の表示）
- パスワード確認入力フィールド
- 利用規約・プライバシーポリシー同意チェックボックス
- 登録ボタン

**バリデーション要件:**
- メールアドレス形式チェック
- パスワード6文字以上チェック
- パスワード一致チェック
- 利用規約・プライバシーポリシー同意チェック（未同意時はボタン無効化）

---

### SC003: パスワードリセット画面

**レイアウト図:**
```
┌──────────────────────────────────┐
│  [<] パスワードリセット          │
├──────────────────────────────────┤
│                                  │
│  登録済みのメールアドレスを      │
│  入力してください。              │
│  パスワードリセット用のリンクが  │
│  送信されます。                  │
│                                  │
│  ┌────────────────────────────┐ │
│  │ メールアドレス              │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ example@email.com          │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │        送信                │ │
│  └────────────────────────────┘ │
│                                  │
└──────────────────────────────────┘
```

**必要な要素:**
- 戻るボタン
- 説明文（パスワードリセットメール送信の案内）
- メールアドレス入力フィールド
- 送信ボタン

**動作要件:**
- 送信中はローディング表示
- 成功時はトースト表示してログイン画面に自動遷移

---

### SC004: マップ画面（メイン画面）

**レイアウト図（現在シーズン）:**
```
┌──────────────────────────────────┐
│                                  │
│         マップ表示領域            │
│         （全画面表示）            │
│                                  │
│    ● 金色/グレーマーカー         │
│      （モードにより色が変わる）  │
│                                  │
│                        [○]  ↑   │
│                        [↻]  右下 │
│                                  │
│  [🗺️ 探検モード]                │
│  または                          │
│  [📍 登録モード]                │
│  または                          │
│  [📍✅ 登録＆獲得モード]        │
│  （ボタンタップで切り替え）      │
│  ※下部中央に配置                │
└──────────────────────────────────┘
```

**レイアウト図（過去シーズン）:**
```
┌──────────────────────────────────┐
│                                  │
│         マップ表示領域            │
│         （全画面表示）            │
│         参照のみ（閲覧専用）      │
│                                  │
│    ● 金色マーカー（全メダル）    │
│                                  │
│                        [○]  ↑   │
│                        [↻]  右下 │
│                                  │
└──────────────────────────────────┘
```

**必要な要素（現在シーズン）:**
- マップ表示領域（全画面）
- メダルマーカー表示
- 現在地ボタン（右下）
- メダル再読み込みボタン（右下、現在地ボタンの下）
- モード切り替えボタン（下部中央、1つのボタンで3モード切り替え）
  - 🗺️ 探検モード
  - 📍 登録モード
  - 📍✅ 登録＆獲得モード

**必要な要素（過去シーズン）:**
- マップ表示領域（全画面）
- メダルマーカー表示（参照のみ、全て金色）
- 現在地ボタン（右下）
- メダル再読み込みボタン（右下、現在地ボタンの下）
- モード切り替えボタンは非表示

**メダル登録方法:**
- マップを長押しして登録（登録モード・登録＆獲得モード時）

**メダルマーカー操作:**

**探検モード:**
- 未獲得メダル（金色）をタップ: 獲得
- 獲得済みメダル（グレー）をタップ: 獲得キャンセル

**登録モード:**
- 自分のメダル（金色）をタップ: 削除
- 他人のメダル（グレー）をタップ: 通報（確認ダイアログ表示）

**登録＆獲得モード:**
- 未獲得メダル（金色）をタップ: 獲得
- 獲得済みメダル（グレー）をタップ:
  - 自分のメダル → 削除
  - 他人のメダル → 獲得キャンセル

**フィードバック要件:**
- 登録成功時: トースト表示（2秒で自動的に消える）
- 削除成功時: トースト表示（2秒で自動的に消える）
- 通報成功時: トースト表示（2秒で自動的に消える）
- 獲得成功時: トースト表示（2秒で自動的に消える）
- 獲得キャンセル時: トースト表示（2秒で自動的に消える）
- エラー時: トースト表示（手動で閉じるまで表示、×ボタン付き）

---

### SC005: マイページ

**レイアウト図:**
```
┌──────────────────────────────────┐
│        マイページ                │
├──────────────────────────────────┤
│                                  │
│  【ユーザー情報】                │
│  ┌────────────────────────────┐ │
│  │ メールアドレス:             │ │
│  │ user@example.com           │ │
│  └────────────────────────────┘ │
│                                  │
│  【メダル統計】                  │
│  ┌────────────────────────────┐ │
│  │ シーズン: 2025/秋 >        │ │
│  │                            │ │
│  │  ┌──────┐    ┌──────┐     │ │
│  │  │  5   │    │  3   │     │ │
│  │  │獲得数│    │登録数│     │ │
│  │  └──────┘    └──────┘     │ │
│  └────────────────────────────┘ │
│                                  │
│  【アプリ情報】                  │
│  ┌────────────────────────────┐ │
│  │ バージョン: 1.0.0          │ │
│  └────────────────────────────┘ │
│                                  │
│  ┌────────────────────────────┐ │
│  │      ログアウト             │ │
│  └────────────────────────────┘ │
│                                  │
└──────────────────────────────────┘
```

**必要な要素:**
- タイトル表示（マイページ）
- ユーザー情報セクション
  - メールアドレス表示
- メダル統計セクション
  - シーズン選択リンク（タップでシーズン選択モーダル表示、例：2025/秋 >）
  - 獲得メダル数（大きな数字で表示、選択中のシーズンの統計）
  - 登録メダル数（大きな数字で表示、選択中のシーズンの統計）
- アプリ情報セクション
  - バージョン情報表示
- ログアウトボタン（確認ダイアログ付き）

**データ取得:**
- シーズン情報: medal_mst_seasonsテーブルから取得
- 初期表示: 現在シーズン（is_current=true）
- 獲得メダル数: medal_collectionsテーブルから選択中のシーズンで絞り込み
- 登録メダル数: medal_medalsテーブルから選択中のシーズンで絞り込み（is_deleted=false）
- 初回マウント時に非同期で読み込み

**シーズン選択動作:**
- シーズンリンクをタップ → シーズン選択モーダル表示
- モーダル内容:
  - シーズン一覧（2025/秋、2025/夏、2025/春...）
  - 現在シーズンには「現在」マーク表示
  - タップでシーズン選択
- シーズン選択後:
  - メダル統計を選択したシーズンで再取得
  - マップ画面の表示シーズンも連動して変更
  - 選択したシーズンを保存（アプリ再起動時も維持）

**ログアウト動作:**
- ログアウトボタンタップ → 確認ダイアログ表示
- 「ログアウトしますか？」で確認
- キャンセル/ログアウト選択可能

---

### SC006: メダルの思い出（ヒストリーパネル）

**注意:** 独立した画面ではなく、マップ画面の下部から出現するボトムシートパネル

**レイアウト図:**
```
┌──────────────────────────────────┐
│         マップ画面（背景）        │
│                                  │
│                                  │
├──────────────────────────────────┤
│  ━━━━                            │
├──────────────────────────────────┤
│  メダルの思い出    [📅] [✕]     │
│  合計 XX 個                      │
├──────────────────────────────────┤
│  ┌────────────────────────────┐ │
│  │ #1   メダルNo. 1234        │ │
│  │      11/28 15:30           │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ #2   メダルNo. 5678        │ │
│  │      11/27 10:15           │ │
│  └────────────────────────────┘ │
│  ┌────────────────────────────┐ │
│  │ #3   メダルNo. 9012        │ │
│  │      11/26 16:45           │ │
│  └────────────────────────────┘ │
│                                  │
│        （スクロール可能）         │
└──────────────────────────────────┘
```

**必要な要素:**
- ドラッグハンドル（パネル高さ調整用）
- タイトル表示
- 獲得メダル数表示
- カレンダーフィルターボタン
- 閉じるボタン
- メダルリスト（スクロール可能）
  - 獲得順番（#1, #2...）
  - メダル番号
  - 獲得日時

**メダルリスト操作:**
- タップ: 地図をそのメダルに移動
- 長押し: 地図上にハイライト表示

**日付フィルター機能:**
- カレンダーUI表示
- メダルのある日付にマーク表示
- 日付選択でフィルタリング
- 全て表示ボタンでフィルターリセット

**パネル動作:**
- 上下ドラッグで高さを段階的に変更
- 下スワイプで閉じる

**空状態表示:**
- まだメダルを獲得していない場合は案内メッセージ表示

---

## レスポンシブ要件

### 対象画面サイズ
- iPhone SE (小型スマートフォン)
- iPhone標準サイズ
- iPhone Pro Max (大型スマートフォン)
- Android標準サイズ
- タブレットは将来対応（現在は対象外）

### Safe Area対応
- iOS: ノッチ・ホームインジケーター考慮
- Android: ステータスバー・ナビゲーションバー考慮

---

## アニメーション要件

### 画面遷移
- スムーズな画面遷移（スライド、フェード）
- 違和感のない自然な動き

### UI要素
- ボタンタップ時のフィードバック
- トースト表示のフェードイン/アウト
- ダイアログ表示のスケールアニメーション
- メダルマーカーのドロップインアニメーション

### ローディング
- 処理中はスピナー表示
- 画面中央に配置
- 背景はオーバーレイで視覚的にブロック

---

## アクセシビリティ要件

### タップ領域
- 最小44px × 44px（指で操作しやすいサイズ）

### コントラスト
- テキストと背景のコントラスト比を十分に確保
- 視認性の高い色使い

### フォントスケーリング
- システムのフォントサイズ設定に追従

### 特別対応
- スクリーンリーダー、VoiceOver等は将来対応予定

---

## ダークモード

### 対応方針
- 現時点では非対応（ライトモードのみ）
- 将来的に需要があれば対応を検討

---

## まとめ

MedalCompassのUI要件は以下の特徴があります：

- **シンプルで直感的**: マップ中心、最小限のUI要素
- **歩きながら使える**: 大きなボタン、タップしやすいデザイン
- **視認性が高い**: 明確な色分け（金色/グレー）
- **快適な操作感**: スムーズなアニメーション、適切なフィードバック
- **クロスプラットフォーム**: iOS/Android両対応

この要件に基づき、後続の設計フェーズで具体的なデザイン・実装を行います。
