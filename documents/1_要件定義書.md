# 要件定義書
## 1. プロジェクト概要
### アプリ名
dqwfunメダルコンパス（MedalCompass）

### アプリコンセプト
- ドラクエウォークの小さなメダルの湧き位置をボタンクリックで登録、共有できる。
- 登録したメダルの湧き位置は、アプリ内のMap上に表示され、全員が参照可能。
- Databaseに登録されたメダルの湧き位置データは公開状態とし、誰でも参照可能。オープンデータ状態とする。
- ログイン認証は昔ながらのメールアドレス/PW方式

### ビジネス戦略
- 無料

### 収益モデル
- なし

### ターゲットユーザー
- ドラクエウォークアプリユーザ

### 想定規模
- 個人開発プロジェクト
- 目標ユーザー数: ～1,000人

## 2. 機能要件

### 2.1 基本機能
- メールアドレス/パスワードによる認証
- ログイン情報の保存（次回起動時に自動入力）
- 地図上に全ユーザーが登録したメダルを表示

#### 3つの動作モード
**探検モード**（デフォルト）
- 全メダルを金色で表示
- メダルタップで獲得/獲得キャンセル
- 獲得済みメダルはグレー表示
- 獲得日時を記録

**登録モード**
- 画面長押しでメダル登録
- 自分のメダル：金色、他人のメダル：グレー
- 自分のメダルをタップで削除
- 他人のメダルをタップで通報

**登録＆獲得モード**
- 画面長押しでメダル登録＋即座に獲得済み扱い
- 全メダルをグレー表示
- 自分のメダルをタップで削除
- 他人のメダルをタップで通報

### 2.2 獲得履歴機能
- 獲得したメダルの履歴を表示
- 獲得日時の降順で表示
- 履歴からメダルタップで地図移動
- 履歴のメダル押下中は地図上でハイライト表示
- 日付でフィルタリング可能

### 2.3 状態保存機能
- 前回のマップ位置・ズームレベルを保存
- 前回選択したモードを保存
- 次回起動時に前回の状態から開始

### 2.4 不正データ対策
- 他ユーザーのメダルを誤メダルとして通報可能
- 5通報でメダル無効化（非表示）
- 10通報でユーザーBAN（全メダル無効化）
- 重複通報の防止
- 通報履歴の保持

## 3. 非機能要件
### 3.1 パフォーマンス
- アプリ起動時間: 3秒以内

### 3.2 セキュリティ
- **DBのデータ保護**:
  - データ登録、削除はRow Level Security (RLS)により、認証済みユーザのみ自分のデータを操作可能とする。
  - データ参照はクライアント端末からSupabaseのpublicスキーマのデータを直接参照可能とする（全員閲覧可能）。
- **データ暗号化**:
  - パスワード：Supabase保存時のハッシュ化（bcrypt等）
  - 個人情報：存在しない
  - 通信：HTTPS/TLS暗号化
- **プライバシー保護**:
  - 位置情報の適切な管理（おおまかな地域のみ表示）
  - 個人を特定できる情報の厳重管理


### 3.3 スケーラビリティ
- 1,000人のアクティブユーザーに対応

### 3.4 運営・保守
- **サポート体制**: 個人のベストエフォート
- **システム監視**: 個人のベストエフォート
- **データバックアップ**: 日次自動バックアップ
- **セキュリティ監視**: 個人のベストエフォート

### 3.5 UI/UX要件
- **デザイン方針**: 一般的なマップアプリにメダルが表示されている、登録ボタンのみの超シンプルUIUX。歩きながら使うアプリなので大きいボタン。
- **基本画面構成**: 地図画面
- **操作性**: 直感的な地図操作と登録操作
- **レスポンシブデザイン**: iOS/Android両対応
- **アクセシビリティ**: 特別な配慮は行わない（標準レベル）

### 3.6 データ管理要件
- **データ保存期間**: 後日検討
- **バックアップ方針**: 日次自動バックアップのみ実装
- **GDPR等海外対応**: 現段階では考慮対象外（日本国内向けサービスとして開始）
- **データ削除**: ユーザーアカウント削除時の基本的なデータ削除のみ実装

## 4. 法的・運営上の注意事項

### 4.1 法的コンプライアンス
- ドラクエウォークの利用規約を破らないこと。あくまでもファンツール。

### 4.2 コンテンツモデレーション
- 文字情報は登録不可のため考慮不要
- 不正なメダル登録に対しては、ユーザーコミュニティによる「誤メダル」通報機能で対応
- 通報機能の悪用（虚偽通報）に対しては、管理者による手動対応

### 4.3 カスタマーサポート体制
- **チャットサポート**: githubのIssueによる問い合わせ
- **対応内容**: 諸々
- **対応言語**: 日本語のみ
- **レスポンス目標**: 個人開発のためベストエフォート
