# 要件定義書
## 1. プロジェクト概要
### アプリ名
dqwfunメダルコンパス（MedalCompass）

### アプリコンセプト
- ドラクエウォークの小さなメダルの湧き位置をボタンクリックで登録、共有できる。
- 登録したメダルの湧き位置は、アプリ内のMap上に表示され、全員が参照可能。
- Databaseに登録されたメダルの湧き位置データは公開状態とし、誰でも参照可能。オープンデータ状態とする。
- ログイン認証は昔ながらのメールアドレス/PW方式

### ビジネス戦略
- 無料

### 収益モデル
- なし

### ターゲットユーザー
- ドラクエウォークアプリユーザ

### 想定規模
- 個人開発プロジェクト
- 目標ユーザー数: ～1,000人

## 2. 機能要件

### 2.1 基本機能
- メールアドレス/パスワードによる認証
- UIにMapが表示されており、そのマップに他のユーザが登録した小さなメダルが表示されている。
- 登録ボタンで現在位置にメダルが存在するというデータを登録する。
- 自分が登録したメダル情報は他のユーザが登録したメダルの色とは異なる表示とする。
- 自分が登録したメダルに対してはクリックし、削除操作が可能。
- 5メートル以内に登録されているメダルがある場合は同一メダルと考えられるため、登録不可とする。
- メダル情報は登録ユーザ情報と合わせて登録する。不正データを登録したユーザのデータ全てを一括で削除可能とするため。

### 2.2 不正データ対策（誤メダル通報機能）
- **誤メダル通報**: 悪意を持ったユーザがメダルのない位置にメダルを登録する場合を想定。他のユーザから「誤メダル」通報を可能とする。
- **メダル無効化**: 「誤メダル」通報を5ユーザから受けたメダルは無効とする（表示されなくなる）。
- **ユーザーBAN**: 「誤メダル」通報を10回受けたユーザは、そのユーザの登録データは全て無効とする（全メダル非表示）。
- **通報の重複防止**: 同一ユーザーが同一メダルに対して複数回通報できないようにする。
- **通報履歴**: 通報されたメダルと通報したユーザーの履歴を保持する。

## 3. 非機能要件
### 3.1 パフォーマンス
- アプリ起動時間: 3秒以内

### 3.2 セキュリティ
- **DBのデータ保護**:
  - データ登録、削除はRow Level Security (RLS)により、認証済みユーザのみ自分のデータを操作可能とする。
  - データ参照はクライアント端末からSupabaseのpublicスキーマのデータを直接参照可能とする（全員閲覧可能）。
  - 5メートル重複チェックはクライアント側で実施する。
- **データ暗号化**:
  - パスワード：Supabase保存時のハッシュ化（bcrypt等）
  - 個人情報：存在しない
  - 通信：HTTPS/TLS暗号化
- **プライバシー保護**:
  - 位置情報の適切な管理（おおまかな地域のみ表示）
  - 個人を特定できる情報の厳重管理


### 3.3 スケーラビリティ
- 1,000人のアクティブユーザーに対応

### 3.4 運営・保守
- **サポート体制**: 個人のベストエフォート
- **システム監視**: 個人のベストエフォート
- **データバックアップ**: 日次自動バックアップ
- **セキュリティ監視**: 個人のベストエフォート

### 3.5 UI/UX要件
- **デザイン方針**: 一般的なマップアプリにメダルが表示されている、登録ボタンのみの超シンプルUIUX。歩きながら使うアプリなので大きいボタン。
- **基本画面構成**: 地図画面
- **操作性**: 直感的な地図操作と登録操作
- **レスポンシブデザイン**: iOS/Android両対応
- **アクセシビリティ**: 特別な配慮は行わない（標準レベル）

### 3.6 データ管理要件
- **データ保存期間**: 後日検討
- **バックアップ方針**: 日次自動バックアップのみ実装
- **GDPR等海外対応**: 現段階では考慮対象外（日本国内向けサービスとして開始）
- **データ削除**: ユーザーアカウント削除時の基本的なデータ削除のみ実装

## 4. 法的・運営上の注意事項

### 4.1 法的コンプライアンス
- ドラクエウォークの利用規約を破らないこと。あくまでもファンツール。

### 4.2 コンテンツモデレーション
- 文字情報は登録不可のため考慮不要
- 不正なメダル登録に対しては、ユーザーコミュニティによる「誤メダル」通報機能で対応
- 通報機能の悪用（虚偽通報）に対しては、管理者による手動対応

### 4.3 カスタマーサポート体制
- **チャットサポート**: githubのIssueによる問い合わせ
- **対応内容**: 諸々
- **対応言語**: 日本語のみ
- **レスポンス目標**: 個人開発のためベストエフォート
